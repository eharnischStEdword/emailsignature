<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Signature Generator | St. Edward Church & School</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #005921;
            --primary-dark: #004518;
            --navy: #003764;
            --green: #00843d;
            --light-gold: #ddcc71;
            --gold: #daaa00;
            --bg: #eef4f1;
            --white: #ffffff;
            --text: #333333;
            --text-muted: #666666;
            --border: #c5d4c9;
            --success: #005921;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .header {
            background: var(--primary);
            color: white;
            padding: 1.5rem 2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            border-bottom: 4px solid var(--light-gold);
        }

        .header-logo {
            width: 80px;
            height: auto;
        }

        .header-text h1 {
            font-family: 'Merriweather', Georgia, serif;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .header-text p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: start;
        }

        @media (max-width: 900px) {
            .layout {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0, 89, 33, 0.08);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .card-header {
            padding: 1rem 1.5rem;
            background: var(--primary);
            color: white;
            font-family: 'Merriweather', Georgia, serif;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .card-body {
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.4rem;
            font-size: 0.9rem;
            color: var(--text);
        }

        label .required {
            color: #c00;
        }

        input, select {
            width: 100%;
            padding: 0.65rem 0.85rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 89, 33, 0.15);
        }

        input::placeholder {
            color: #999;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 100px 1fr 1fr;
            gap: 1rem;
        }

        .phone-section {
            background: var(--bg);
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 1.25rem;
        }

        .phone-section label {
            margin-bottom: 0.75rem;
        }

        .radio-group {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-weight: normal;
        }

        .radio-label input[type="radio"] {
            width: auto;
            margin: 0;
        }

        .ext-field {
            margin-top: 0.75rem;
        }

        .ext-field label {
            font-weight: normal;
            font-size: 0.85rem;
        }

        .ext-field input {
            width: 120px;
        }

        .fax-notice {
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-muted);
            display: none;
        }

        .fax-notice.visible {
            display: block;
        }

        .preview-area {
            background: #fafafa;
            border: 1px dashed var(--border);
            border-radius: 4px;
            padding: 1.5rem;
            min-height: 220px;
        }

        .signature-preview {
            font-family: Arial, sans-serif;
            font-size: 14px;
            line-height: 1.4;
            color: #333333;
        }

        .button-group {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.25rem;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            font-size: 0.95rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: white;
        }

        .btn svg {
            width: 18px;
            height: 18px;
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--primary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 6px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .instructions {
            margin-top: 2rem;
            padding: 1.5rem;
            background: var(--white);
            border-radius: 8px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 12px rgba(0, 89, 33, 0.08);
        }

        .instructions h3 {
            font-family: 'Merriweather', Georgia, serif;
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .instructions ol {
            margin-left: 1.25rem;
        }

        .instructions li {
            margin-bottom: 0.5rem;
        }

        .instructions code {
            background: var(--bg);
            padding: 0.15rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .hidden-signature {
            position: absolute;
            left: -9999px;
            top: -9999px;
        }

        .divider {
            border: none;
            border-top: 2px solid var(--gold);
            margin: 1.5rem 0;
        }
    </style>
</head>
<body>
    <header class="header">
        <img src="https://raw.githubusercontent.com/eharnischStEdword/emailsignature/main/STElogo.png" alt="St. Edward" class="header-logo">
        <div class="header-text">
            <h1>Email Signature Generator</h1>
            <p>St. Edward Church & School</p>
        </div>
    </header>

    <main class="container">
        <div class="layout">
            <div class="card">
                <div class="card-header">Your Information</div>
                <div class="card-body">
                    <div class="form-row-3">
                        <div class="form-group">
                            <label for="honorific">Title <span class="required">*</span></label>
                            <select id="honorific" required onchange="updatePreview()">
                                <option value="">Select</option>
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Miss">Miss</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Fr.">Fr.</option>
                                <option value="Dcn.">Dcn. (Permanent Deacon)</option>
                                <option value="Rev. Mr.">Rev. Mr. (Transitional Deacon)</option>
                                <option value="Msgr.">Msgr.</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="firstName">First Name <span class="required">*</span></label>
                            <input type="text" id="firstName" placeholder="John" required oninput="updatePreview()">
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name <span class="required">*</span></label>
                            <input type="text" id="lastName" placeholder="Smith" required oninput="updatePreview()">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="credentials">Credentials (optional)</label>
                        <input type="text" id="credentials" placeholder="Ph.D., M.Ed., etc." oninput="updatePreview()">
                    </div>

                    <div class="form-group">
                        <label for="position">Title / Position <span class="required">*</span></label>
                        <input type="text" id="position" placeholder="Principal" required oninput="updatePreview()">
                    </div>

                    <hr class="divider">

                    <div class="phone-section">
                        <label>Phone <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="location" value="church" checked>
                                Church (615) 833-5520
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="location" value="school">
                                School (615) 833-5770
                            </label>
                        </div>
                        <div class="ext-field">
                            <label for="extension">Extension (optional)</label>
                            <input type="text" id="extension" placeholder="123" oninput="updatePreview()">
                        </div>
                        <div id="faxNotice" class="fax-notice">
                            School Fax (615) 833-9739 will be included automatically.
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="email">Email <span class="required">*</span></label>
                        <input type="email" id="email" placeholder="jsmith@stedward.org" required oninput="updatePreview()">
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Preview</div>
                <div class="card-body">
                    <div class="preview-area">
                        <div id="signaturePreview" class="signature-preview"></div>
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn btn-primary" onclick="copySignature()">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            </svg>
                            Copy Signature
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="downloadSignature()">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Download HTML
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="instructions">
            <h3>How to Add Your Signature in Outlook</h3>
            
            <p style="margin-bottom: 1rem;"><strong>Step 1:</strong> Click <strong>Copy Signature</strong> above. You may need to grant your browser permission to access the clipboard.</p>
            
            <p style="margin-bottom: 0.5rem;"><strong>Step 2:</strong> Follow the instructions for your version of Outlook:</p>
            
            <div style="background: var(--bg); padding: 1rem; border-radius: 6px; margin: 1rem 0;">
                <p style="font-weight: 600; margin-bottom: 0.75rem;">New Outlook (2024+)</p>
                <ol style="margin-left: 1.25rem;">
                    <li>Click the <strong>Settings</strong> gear icon (top right)</li>
                    <li>Select <strong>Accounts</strong> → <strong>Signatures</strong></li>
                    <li>Click <strong>+ New signature</strong> and give it a name</li>
                    <li>Click in the signature text box and paste (Ctrl+V or Cmd+V)</li>
                    <li>Under "Select default signatures," choose your new signature for <strong>New messages</strong> and <strong>Replies/forwards</strong></li>
                    <li>Click <strong>Save</strong></li>
                </ol>
            </div>
            
            <div style="background: var(--bg); padding: 1rem; border-radius: 6px; margin: 1rem 0;">
                <p style="font-weight: 600; margin-bottom: 0.75rem;">Classic Outlook (Desktop)</p>
                <ol style="margin-left: 1.25rem;">
                    <li>Click <strong>New Email</strong> to open a compose window</li>
                    <li>In the Message tab, click <strong>Signature</strong> → <strong>Signatures...</strong></li>
                    <li>Click <strong>New</strong>, enter a name, and click <strong>OK</strong></li>
                    <li>Click in the "Edit signature" box and paste (Ctrl+V)</li>
                    <li>Under "Choose default signature," select your new signature for <strong>New messages</strong> and <strong>Replies/forwards</strong></li>
                    <li>Click <strong>OK</strong></li>
                </ol>
            </div>
            
            <p style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-muted);"><strong>Note:</strong> If pasting doesn't preserve formatting in Classic Outlook for Windows, use the <strong>Download HTML</strong> button instead. Save the file to your Signatures folder (typically <code>C:\Users\[YourName]\AppData\Roaming\Microsoft\Signatures</code>), then select it in Outlook.</p>
        </div>
    </main>

    <div id="toast" class="toast">Signature copied to clipboard!</div>

    <div id="hiddenSignature" class="hidden-signature"></div>

    <script>
        // Configuration
        const CONFIG = {
            logoUrl: 'https://raw.githubusercontent.com/eharnischStEdword/emailsignature/main/STElogo.png',
            primaryColor: '#005921',
            goldColor: '#ddcc71',
            locations: {
                church: {
                    phone: '(615) 833-5520',
                    address: '188 Thompson Lane',
                    cityStateZip: 'Nashville, TN 37211',
                    fax: null
                },
                school: {
                    phone: '(615) 833-5770',
                    address: '190 Thompson Lane',
                    cityStateZip: 'Nashville, TN 37211',
                    fax: '(615) 833-9739'
                }
            },
            websites: [
                { display: 'stedward.org', url: 'https://stedward.org' },
                { display: 'ses.stedward.org', url: 'https://ses.stedward.org' }
            ],
            socials: {
                facebook: 'https://www.facebook.com/stedwardschool',
                instagram: 'https://www.instagram.com/stedwardcommunity/',
                youtube: 'https://www.youtube.com/@StEdwardChurchAndSchool'
            }
        };

        // Social icon SVGs (inline for email compatibility) - St. Edward green
        const SOCIAL_ICONS = {
            facebook: 'data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDA1OTIxIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTIgMi4wMzk5OEM2LjUgMi4wMzk5OCAyIDYuNTI5OTggMiAxMi4wNkMyIDE3LjA2IDUuNjYgMjEuMjEgMTAuNDQgMjEuOTZWMTQuOTZINy45VjEyLjA2SDEwLjQ0VjkuODQ5OThDMTAuNDQgNy4zMzk5OCAxMS45MyA1Ljk1OTk4IDE0LjIyIDUuOTU5OThDMTUuMzEgNS45NTk5OCAxNi40NSA2LjE0OTk4IDE2LjQ1IDYuMTQ5OThWOC42MTk5OEgxNS4xOUMxMy45NSA4LjYxOTk4IDEzLjU2IDkuMzg5OTggMTMuNTYgMTAuMThWMTIuMDZIMTYuMzRMMTUuODkgMTQuOTZIMTMuNTZWMjEuOTZDMTUuOTE2NCAyMS41ODc4IDE4LjA2MjIgMjAuMzg1NSAxOS42MDk5IDE4LjU3QzIxLjE1NzYgMTYuNzU0NiAyMi4wMDU0IDE0LjQ0NTYgMjIgMTIuMDZDMjIgNi41Mjk5OCAxNy41IDIuMDM5OTggMTIgMi4wMzk5OFoiLz48L3N2Zz4K',
            instagram: 'data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDA1OTIxIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04LDIgTDE2LDIgQzE5LjMxMzcwODUsMiAyMiw0LjY4NjI5MTUgMjIsOCBMMjIsMTYgQzIyLDE5LjMxMzcwODUgMTkuMzEzNzA4NSwyMiAxNiwyMiBMOCwyMiBDNC42ODYyOTE1LDIyIDIsMTkuMzEzNzA4NSAyLDE2IEwyLDggQzIsNC42ODYyOTE1IDQuNjg2MjkxNSwyIDgsMiBaIE04LDQgQzUuNzkwODYxLDQgNCw1Ljc5MDg2MSA0LDggTDQsMTYgQzQsMTguMjA5MTM5IDUuNzkwODYxLDIwIDgsMjAgTDE2LDIwIEMxOC4yMDkxMzksMjAgMjAsMTguMjA5MTM5IDIwLDE2IEwyMCw4IEMyMCw1Ljc5MDg2MSAxOC4yMDkxMzksNCAxNiw0IEw4LDQgWiBNMTIsMTcgQzkuMjM4NTc2MjUsMTcgNywxNC43NjE0MjM3IDcsMTIgQzcsOS4yMzg1NzYyNSA5LjIzODU3NjI1LDcgMTIsNyBDMTQuNzYxNDIzNyw3IDE3LDkuMjM4NTc2MjUgMTcsMTIgQzE3LDE0Ljc2MTQyMzcgMTQuNzYxNDIzNywxNyAxMiwxNyBaIE0xMiwxNSBDMTMuNjU2ODU0MiwxNSAxNSwxMy42NTY4NTQyIDE1LDEyIEMxNSwxMC4zNDMxNDU4IDEzLjY1Njg1NDIsOSAxMiw5IEMxMC4zNDMxNDU4LDkgOSwxMC4zNDMxNDU4IDksMTIgQzksMTMuNjU2ODU0MiAxMC4zNDMxNDU4LDE1IDEyLDE1IFogTTE3LDggQzE2LjQ0NzcxNTMsOCAxNiw3LjU1MjI4NDc1IDE2LDcgQzE2LDYuNDQ3NzE1MjUgMTYuNDQ3NzE1Myw2IDE3LDYgQzE3LjU1MjI4NDcsNiAxOCw2LjQ0NzcxNTI1IDE4LDcgQzE4LDcuNTUyMjg0NzUgMTcuNTUyMjg0Nyw4IDE3LDggWiIvPjwvc3ZnPgo=',
            youtube: 'data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDA1OTIxIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgLTMgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTcuOTg4NDMyLDkuNTg1ODggTDcuOTg4NDMyLDMuOTc0MjUgQzkuOTgwNjM4LDQuOTExNjggMTEuNTIzNjAyLDUuODE3MiAxMy4zNDg0NjMsNi43OTM1MyBDMTEuODQzMzUxLDcuNjI4MjQgOS45ODA2MzgsOC41NjQ2OCA3Ljk4ODQzMiw5LjU4NTg4IE0xOS4wOTA5OTgsMS4xODI4OSBDMTguNzQ3MzQzLDAuNzMwMTMgMTguMTYxNjM0LDAuMzc4MDkgMTcuNTM4MDczLDAuMjYxNDEgQzE1LjcwNTI0MywtMC4wODY2NCA0LjI3MDk3NCwtMC4wODc2MyAyLjQzOTE0MSwwLjI2MTQxIEMxLjkzOTA5NywwLjM1NTE1IDEuNDkzODM5LDAuNTgxNTMgMS4xMTEzMzUsMC45MzM1NyBDLTAuNTAwMzYsMi40Mjk0NyAwLjAwNDY2NCwxMC40NTE1MSAwLjM5MzE0NSwxMS43NTA5NiBDMC41NTY1MDUsMTIuMzEzNDIgMC43Njc2NzksMTIuNzE5MzEgMS4wMzM2MzksMTIuOTg1NTggQzEuMzc2Mjk4LDEzLjMzNzYxIDEuODQ1NDYzLDEzLjU3OTk1IDIuMzg0MzU1LDEzLjY4ODY1IEMzLjg5MzQ1MSwxNC4wMDA4IDExLjY2ODAzNywxNC4xNzUzMiAxNy41MDYxOTgsMTMuNzM1NTIgQzE4LjA0NDA5NCwxMy42NDE3OCAxOC41MjAyMzEsMTMuMzkxNDcgMTguODk1NzYyLDEzLjAyNDQ3IEMyMC4zODU5MzIsMTEuNTM0NTUgMjAuMjg0MzMsMy4wNjE3NCAxOS4wOTA5OTgsMS4xODI4OSIvPjwvc3ZnPgo='
        };

        // Get form elements
        const inputs = {
            honorific: document.getElementById('honorific'),
            firstName: document.getElementById('firstName'),
            lastName: document.getElementById('lastName'),
            credentials: document.getElementById('credentials'),
            position: document.getElementById('position'),
            extension: document.getElementById('extension'),
            email: document.getElementById('email')
        };

        const locationRadios = document.querySelectorAll('input[name="location"]');
        const faxNotice = document.getElementById('faxNotice');

        // Update preview on any input change
        Object.values(inputs).forEach(input => {
            input.addEventListener('input', updatePreview);
            input.addEventListener('change', updatePreview);
            input.addEventListener('keyup', updatePreview);
        });

        locationRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                faxNotice.classList.toggle('visible', radio.value === 'school');
                updatePreview();
            });
        });

        // Handle browser autofill (which doesn't always trigger input events)
        setTimeout(updatePreview, 100);
        setTimeout(updatePreview, 500);
        document.addEventListener('DOMContentLoaded', updatePreview);

        function getSelectedLocation() {
            const selected = document.querySelector('input[name="location"]:checked');
            return selected ? selected.value : 'church';
        }

        function generateSignatureHTML() {
            const honorific = inputs.honorific.value;
            const firstName = inputs.firstName.value.trim();
            const lastName = inputs.lastName.value.trim();
            const credentials = inputs.credentials.value.trim();
            const position = inputs.position.value.trim();
            const extension = inputs.extension.value.trim();
            const email = inputs.email.value.trim();
            const location = getSelectedLocation();
            const loc = CONFIG.locations[location];

            const fullName = [honorific, firstName, lastName].filter(Boolean).join(' ');
            const nameWithCreds = credentials ? `${fullName}, ${credentials}` : fullName;
            const phoneWithExt = extension ? `${loc.phone} ext. ${extension}` : loc.phone;

            // Build websites HTML
            const websitesHTML = CONFIG.websites.map(w => 
                `<a href="${w.url}" target="_blank" style="color:${CONFIG.primaryColor};text-decoration:none;">${w.display}</a>`
            ).join(' | ');

            // Build social icons HTML
            const socialHTML = `
                <a href="${CONFIG.socials.facebook}" target="_blank" style="text-decoration:none;margin-right:8px;"><img src="${SOCIAL_ICONS.facebook}" alt="Facebook" width="20" height="20" style="border:0;vertical-align:middle;"></a>
                <a href="${CONFIG.socials.instagram}" target="_blank" style="text-decoration:none;margin-right:8px;"><img src="${SOCIAL_ICONS.instagram}" alt="Instagram" width="20" height="20" style="border:0;vertical-align:middle;"></a>
                <a href="${CONFIG.socials.youtube}" target="_blank" style="text-decoration:none;"><img src="${SOCIAL_ICONS.youtube}" alt="YouTube" width="20" height="20" style="border:0;vertical-align:middle;"></a>
            `;

            return `
<table cellpadding="0" cellspacing="0" border="0" style="font-family:Arial,sans-serif;font-size:14px;line-height:1.5;color:#333333;">
    <tr>
        <td style="padding-right:15px;vertical-align:top;border-right:3px solid ${CONFIG.goldColor};">
            <img src="${CONFIG.logoUrl}" alt="St. Edward Church & School" width="100" style="display:block;border:0;">
        </td>
        <td style="padding-left:15px;vertical-align:top;">
            <table cellpadding="0" cellspacing="0" border="0">
                <tr>
                    <td style="font-weight:bold;font-size:16px;color:${CONFIG.primaryColor};padding-bottom:2px;">
                        ${nameWithCreds || 'Your Name'}
                    </td>
                </tr>
                ${position ? `<tr><td style="color:#333333;padding-bottom:6px;">${position}</td></tr>` : ''}
                <tr>
                    <td style="font-weight:bold;color:${CONFIG.primaryColor};padding-bottom:2px;">St. Edward Church & School</td>
                </tr>
                <tr>
                    <td style="color:#666666;font-size:13px;">${loc.address}</td>
                </tr>
                <tr>
                    <td style="color:#666666;font-size:13px;padding-bottom:6px;">${loc.cityStateZip}</td>
                </tr>
                <tr>
                    <td style="font-size:13px;">
                        <strong>P:</strong> <a href="tel:${loc.phone.replace(/[^\d]/g, '')}" style="color:#333333;text-decoration:none;">${phoneWithExt}</a>
                    </td>
                </tr>
                ${loc.fax ? `<tr><td style="font-size:13px;"><strong>F:</strong> ${loc.fax}</td></tr>` : ''}
                ${email ? `<tr><td style="font-size:13px;"><strong>E:</strong> <a href="mailto:${email}" style="color:${CONFIG.primaryColor};text-decoration:none;">${email}</a></td></tr>` : ''}
                <tr>
                    <td style="font-size:13px;padding-bottom:8px;">
                        <strong>W:</strong> ${websitesHTML}
                    </td>
                </tr>
                <tr>
                    <td style="padding-top:4px;">
                        ${socialHTML}
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
            `.trim();
        }

        function generatePlainText() {
            const honorific = inputs.honorific.value;
            const firstName = inputs.firstName.value.trim();
            const lastName = inputs.lastName.value.trim();
            const credentials = inputs.credentials.value.trim();
            const position = inputs.position.value.trim();
            const extension = inputs.extension.value.trim();
            const email = inputs.email.value.trim();
            const location = getSelectedLocation();
            const loc = CONFIG.locations[location];

            const fullName = [honorific, firstName, lastName].filter(Boolean).join(' ');
            const nameWithCreds = credentials ? `${fullName}, ${credentials}` : fullName;
            const phoneWithExt = extension ? `${loc.phone} ext. ${extension}` : loc.phone;

            let lines = ['--'];
            if (nameWithCreds) lines.push(nameWithCreds);
            if (position) lines.push(position);
            lines.push('St. Edward Church & School');
            lines.push(loc.address);
            lines.push(loc.cityStateZip);
            lines.push(`P: ${phoneWithExt}`);
            if (loc.fax) lines.push(`F: ${loc.fax}`);
            if (email) lines.push(`E: ${email}`);
            lines.push(`W: ${CONFIG.websites.map(w => w.display).join(' | ')}`);

            return lines.join('\n');
        }

        function updatePreview() {
            const preview = document.getElementById('signaturePreview');
            preview.innerHTML = generateSignatureHTML();
        }

        function copySignature() {
            const html = generateSignatureHTML();
            const plainText = generatePlainText();

            const hiddenDiv = document.getElementById('hiddenSignature');
            hiddenDiv.innerHTML = html;

            const range = document.createRange();
            range.selectNodeContents(hiddenDiv);
            
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);

            try {
                if (navigator.clipboard && window.ClipboardItem) {
                    const blob = new Blob([html], { type: 'text/html' });
                    const textBlob = new Blob([plainText], { type: 'text/plain' });
                    const item = new ClipboardItem({
                        'text/html': blob,
                        'text/plain': textBlob
                    });
                    navigator.clipboard.write([item]).then(() => {
                        showToast('Signature copied to clipboard!');
                    }).catch(() => {
                        document.execCommand('copy');
                        showToast('Signature copied to clipboard!');
                    });
                } else {
                    document.execCommand('copy');
                    showToast('Signature copied to clipboard!');
                }
            } catch (err) {
                console.error('Copy failed:', err);
                showToast('Copy failed. Try downloading instead.');
            }

            selection.removeAllRanges();
        }

        function downloadSignature() {
            const html = `<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Email Signature</title>
</head>
<body>
${generateSignatureHTML()}
</body>
</html>`;

            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'signature.htm';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showToast('Signature downloaded!');
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Initialize preview
        updatePreview();
    </script>
</body>
</html>
